(window.webpackJsonp=window.webpackJsonp||[]).push([[270],{660:function(s,t,a){"use strict";a.r(t);var e=a(0),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"正文开始"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#正文开始"}},[s._v("#")]),s._v(" 正文开始")]),s._v(" "),t("p",[s._v("这是一次骚操作，从需求开始，就充满着骚骚的气息，容我从头讲述一下。")]),s._v(" "),t("p",[s._v("前后端分离的测试环境，一般都有好几套以应对日常的测试需求，而前端同学为了灵活，就在自己的项目当中做了灵活的转发，也就是从文件中定义后端地址，从而确定当前环境是转发到对应的后端服务去的。")]),s._v(" "),t("p",[s._v("这么做的好处就是比较灵活，不至于因为写死在配置当中，然后可能对应的环境还并不能同步的用于测试，从而影响测试进度，但是弊端也很明显，那就是太过灵活，一方面针对新来的小伙伴来说，学习成本会增加，另一方面就是如果某一方出了问题，不好定位。")]),s._v(" "),t("p",[s._v("因此，为了解决这一尴尬，前端大哥找我提了需求，大概意思就是，能否把相关的构建信息打印出来，当我了解到这个将要打印的东东是在一个固定的位置时，我就想，简单啊，给你一cat不就行了，然而大哥不满足呀，他想要这结果能输出在项目某个界面来的，从而让构建的人一眼就能看到什么是什么。")]),s._v(" "),t("p",[s._v("我想，如果我会开发，可能这是一个分分钟解决的问题，奈何我不懂，于是只能在自己所掌握的技能范围内，尽量的将其需求实现出来。")]),s._v(" "),t("p",[s._v("经过一番折腾，最终实现效果如下：")]),s._v(" "),t("p",[t("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/75e94dc55aebaf1f.jpg",alt:"image"}})]),s._v(" "),t("p",[s._v("其中模糊部分是构建人的名字，后边的testapp则代表这次构建的前段对应的是testapp这个后端地址。")]),s._v(" "),t("p",[s._v("实现起来也非常简单，首先需要安装两个插件：")]),s._v(" "),t("ul",[t("li",[s._v("user build vars #定义名称全局变量")]),s._v(" "),t("li",[s._v("description setter #自定义描述信息")])]),s._v(" "),t("p",[s._v("首先在"),t("code",[s._v("构建环境")]),s._v("当中选中如下选项，从而定义出构建人信息的全局变量。")]),s._v(" "),t("p",[t("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/3f6484e82b7ffd91.jpg",alt:"image"}})]),s._v(" "),t("p",[s._v("接着在"),t("code",[s._v("执行shell")]),s._v("当中添加两句话，把需要的内容给取出来：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("A")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" $WORKSPACE/ecosystem.json "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -A "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"测试环境"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v("  testapp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v('"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print $4}'")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print $1}'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$A")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /media/version.txt\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("然后在"),t("code",[s._v("构建")]),s._v("当中找到"),t("code",[s._v("update build name")]),s._v("这个工具，对刚刚定义的内容进行读取：")]),s._v(" "),t("p",[t("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/a3c3b558f0c99779.jpg",alt:"image"}})]),s._v(" "),t("p",[s._v("接着还是在"),t("code",[s._v("构建")]),s._v("当中再添加一个"),t("code",[s._v("set build description")]),s._v("，写下描述信息即可：")]),s._v(" "),t("p",[t("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/76375b61d7477e74.jpg",alt:"image"}})])])}),[],!1,null,null,null);t.default=r.exports}}]);