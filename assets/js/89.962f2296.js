(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{481:function(s,t,a){"use strict";a.r(t);var e=a(0),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"_1-简单解释"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-简单解释"}},[s._v("#")]),s._v(" 1，简单解释")]),s._v(" "),t("ul",[t("li",[t("p",[t("code",[s._v("by:")]),s._v(" 向量中只保留列出的标签(维度)，其余标签则移除，必须指明标签列表。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("without:")]),s._v(" 用于从计算结果中移除列举的标签(维度)，而保留其它标签。")])])]),s._v(" "),t("p",[s._v("通常如上两个函数都配合"),t("code",[s._v("sum()")]),s._v("函数一同出现，by用于聚合我们关心的列，而without则可以直接理解为by的相反用法。")]),s._v(" "),t("h2",{attrs:{id:"_2-简单示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-简单示例"}},[s._v("#")]),s._v(" 2，简单示例")]),s._v(" "),t("p",[s._v("首先有一个基础字段查询：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("prometheus_http_requests_total\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/131e836c5ee8dcc8.jpg",alt:"image-20210802211525363"}})]),s._v(" "),t("p",[s._v("这里随便拿出一条结果来做参照：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("prometheus_http_requests_total"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),s._v(",endpoint"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http"')]),s._v(",handler"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/-/reload"')]),s._v(",instance"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.26.10.182:8080"')]),s._v(",job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus"')]),s._v(",namespace"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"monitoring"')]),s._v(",pod"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prometheus-1"')]),s._v(",roles"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"monitor"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15467")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("通常我们结合sum来得出每个instance的value：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("sum"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prometheus_http_requests_total"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" by "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/72c865c3651e115f.jpg",alt:"image-20210802211629103"}})]),s._v(" "),t("p",[s._v("此处可以看到使用sum函数之后可通过by方法获取到我们关心的字段。")]),s._v(" "),t("p",[s._v("那么without的用法如上边相反，比如有一个roles的字段我们用不到，可以使用如下方法：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("sum"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prometheus_http_requests_total"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" without "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("roles"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/9b1f5e202123e862.jpg",alt:"image-20210802211924802"}})]),s._v(" "),t("p",[s._v("能够看到对应的roles字段没有了。without方法多用在表格的绘制中，让我们能够灵活地控制字段的取舍。")])])}),[],!1,null,null,null);t.default=r.exports}}]);